{% extends 'base/base_usuarios.html' %}
{% load staticfiles %}
{% load widget_tweaks %}

{% block javascript %}
  <script type="text/javascript" src="{% static 'js/jquery.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/administrador.js'%}"></script>
  <script type="text/javascript" src="{% static 'js/popper.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/jquery.simplePagination.js' %}"></script>
{% endblock %}

{% block more-estilos %}
  <link rel="stylesheet" type="text/css" href="{% static 'css/simplePagination.css' %}"/>
  <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.css' %}"/>
{% endblock %}

{% block botones %}
  <p><li class="dashboard"><a href="{% url 'agentes_a_cargo' %}">Mis agentes</a></li></p>
  <p><li class="dashboard"><a href="{% url 'reportes_agentes' %}">Generar Reportes</a></li></p>
  <p><li><a data-toggle="collapse" href="#collapseOne">Periodo</a></li></p>
  <div id="collapseOne" class="collapse">
      <div class="panel-body">
          <ul class="">
              <li><a href="#">2018</a></li>
              <li><a href="#">2017</a></li>
              <li><a href="#">2016</a></li>
          </ul>
      </div>
  </div>
  <p><li><a data-toggle="collapse" href="#collapseDos">Liquidaciones Finales</a></li></p>
  <div id="collapseDos" class="collapse">
      <div class="panel-body">
          <ul class="">
              <li><a href="#">2018</a></li>
              <li><a href="#">2017</a></li>
              <li><a href="#">2016</a></li>
          </ul>
      </div>
  </div>
{% endblock %}

{% block extra %}

  {% if messages %}
    {% for message in messages %}
    <div align="center">
      <div class="alert {% if message.tags %} alert-{{ message.tags }}{% endif %}">{{ message|safe }}</div>
    </div>
    {% endfor %}
  {% endif %}


  {% if lista_empresas %}
           <div class="col-md-12">
             <form method="get" style="background-color:#BBDEFB;">
               <div class="row align-items-end">
                  <div class="col-sm-4 col-md-3" style="margin-left:15px">
                    <strong>{{ lista_personas.form.documento.label_tag }}</strong>
                    {% render_field lista_personas.form.documento class="form-control" %}
                  </div>
                  <div class="col-sm-4 col-md-3">
                    <strong>{{ lista_personas.form.nya.label_tag }}</strong>
                    {% render_field lista_personas.form.nya class="form-control" %}
                  </div>
                  <div class="col-sm-4 col-md-3">
                  <strong>{{ lista_personas.form.cuil.label_tag }}</strong>
                  {% render_field lista_personas.form.cuil class="form-control" %}
                  </div>
                  <div class="w-100"></div>
                  <div class="col-sm-4 col-md-3" style="margin-left:15px; margin-top:15px">
                     <strong>SAF:<strong>
                     <select name="saf" style="max-width:100%; margin-bottom:15px; font-size: 70%" class="form-control">
                          {% for empresa in lista_empresas %}
                            <option value="{{empresa}}">{{empresa.descrip}} ({{empresa}})</option>
                          {% endfor %}
                     </select>
                  </div>
                  <div class="col">
                     <button style="margin-bottom:15px" type="submit" name="boton-buscar" class="btn btn-primary">
                       <i class="fa fa-search"> Filtrar</i>
                    </button>
                  </div>
               </div>
           </form>
         </div>

          <div class="col-md-12">
            <table style="margin:auto;" id="miTabla" class="table table-bordered">
                <thead style="background-color:#cccccc; text-align:center;">
                  <tr>
                    <th style="width:100px;">Documento</th>
                    <th style="width:100px;">Nombre y Apellido</th>
                    <th style="width:100px;">Cuil</th>
                  </tr>
                </thead>
                <style>
                </style>
                <tbody >
                  {% for persona in lista_personas.qs %}
                    <tr class="paginate" style="cursor:pointer" data-href="{% url 'liquidaciones_agente' documento=persona.documento %}">
                      <td onmouseover="hover()">{{ persona.documento }}</td>
                      <td onmouseover="hover()">{{ persona.nya }}</td>
                      <td onmouseover="hover()">{{ persona.cuil }}</td>
                    </tr>
                  {% endfor %}
                </tbody>
                </table>
                {%if lista_personas.qs%}
                <div class="row">
                  <div class="col-md-10" style="margin:auto;">
                    <div class= "dark-theme" id="page-nav"></div>
                    </div>
                </div>
                {% endif %}
          </div>
      {% endif %}
  {% endblock %}


{% block reportes %}
  {% if lista_saf %}

       <div class="col-md-10">
         <form method="post" style="background-color:#BBDEFB;">
           {% csrf_token %}
            <div class="row">

              <div class="col-md-3" style="margin:auto; margin-top:15px">
                <strong>Mes</strong>
                <select name="mes" style="max-width:100%; font-size: 70%" class="form-control">
                  {% for values in lista_meses %}
                    <option value="{{values.id}}">{{values.nombre}}</option>
                  {% endfor %}
                </select>
              </div>

               <div class="col-md-3"style="margin:auto; margin-top:15px">
                  <strong>SAF</strong>
                 <select name="saf" style="max-width:100%; font-size: 70%" class="form-control">
                      {% for empresa in lista_saf %}
                        <option value="{{empresa}}">{{empresa.descrip}} ({{empresa}})</option>
                      {% endfor %}
                 </select>
               </div>

            </div>

            <div class="col-md-12" style="margin-top:40" align="center">
              <button type="submit" name="boton-buscar" class="btn btn-primary" style="margin-bottom:15px; background-color: green;">
               <i class="fa fa-file-excel-o"> EXCEL</i>
              </button>
            </div>

          </form>
        </div>

      {% if tabla_reportes %}
    		<div id="centrado-de-tabla">
          <div align="center">
              <strong>{{nombre_persona}}</strong>
          <div>
    			     {% autoescape off %}{{tabla_reportes}}{% endautoescape %}
    		  </div>
        </div>
      </div>
      {% endif %}
    {% endif%}
{% endblock %}


{% block tabla-liquidaciones %}
  <div class="container" style="width:100%; overflow-x:auto; overflow-y:auto">
    <div class="row">
      <div class="col-md-1">
        {% if meses %}
        <div class="container" style="background-color:#ccc; border-radius:5px; margin-top:40; width:150px;">
          <h5 align="center">Filtros</h5>
          <form method="post">  {% csrf_token %}
            {% for values in meses %}
              <div class="checkbox" style="display:block;">
                <label><input type="checkbox" name="check" value="{{values}}">  {{values}}</label>
              </div>
            {% endfor %}
            <label><input type="checkbox" onClick="toggle(this)">Todos</label>
            <div align="center">
              <button type="submit" name="boton-buscar" class="btn btn-primary" style="font-size:80%; margin-bottom:15px; margin-top:15px">
                  <i class="fa fa-search"> Filtrar</i>
             </button>
             </div>
          </form>
        </div>
        <div class="container" style="background-color:#ccc; border-radius:5px; width:150px;">
          <h5 align="center">Imprimir</h5>
          <div align="center">
            <button type="submit" class="btn btn-primary" onclick="funcion({{doc}});" style="font-size:80%; margin-bottom:15px; margin-top:15px">
              <i class="fa fa-file"> </i>  <span class="glyphicon glyphicon-search"></span> PDF
           </button>
          </div>
        </div>
      {% endif %}
      </div>

      <div class="col-md-10">
        	{% if tabla %}
              <div align="center" style="padding-left:80">
                  <strong>{{nombre_persona}}</strong>
              <div>
        			     {% autoescape off %}{{tabla}}{% endautoescape %}
        		  </div>
        	{% endif %}
          </div>
      </div>
  </div>
 </div>

  <script type="text/javascript">
  function funcion(dni){
    var url = "{% url 'liquidaciones_a_pdf' documento=0 %}".replace('0', dni);
    window.location.href = url;}
  </script>

{% endblock %}
